<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>speed match</title>
    <script src="../speed-match/cards.js"></script>
    <script src="../speed-match/control.js"></script>
    <script src="../speed-match/score.js"></script>
    <script src="../speed-match/initial.js"></script>
    <script src="../speed-match/stack.js"></script>
    <script src="../speed-match/jquery-3.5.1.min.js"></script>

</head>
<body>

<div style="width: 300px;height: 20px;background-color: yellow" id="clock"></div>
<div style="width: 300px;height: 20px;background-color: yellow" id="count"></div>
<div style="width: 200px;height: 200px;background-color: red" id="gone"></div>
<div style="width: 200px;height: 200px;background-color: blue" id="save"></div>

<script>
    var saveNode = document.getElementById("save");
    var goneNode = document.getElementById("gone");
    var todayCardStack = initialCardsStack()
    var popNb = null;
    var goneValue = null;
    showSave(todayCardStack.peek())
    function pop(){
        popNb = todayCardStack.pop();
        goneValue=popNb;
        showGone(goneValue)
        popNb = todayCardStack.peek();
        showSave(popNb)
    }

    var int=self.setInterval("clock()",1000);
    var countIntervalId=self.setInterval("count()",1000);
    function clock()
    {
        var d=new Date();
        var t=d.toLocaleTimeString();
        document.getElementById("clock").innerHTML=t;
    }
    function count(){
        document.getElementById("count").innerHTML=countDown(6);
    }
    clock()
    var countTime = null;

    //倒计时
    function countDown(time) {
        if (countTime == null) {
            countTime = time;
        }
        if (countTime==0){
            clearInterval(countIntervalId)
            showGone(goneValue)
            pop()
            return "start";
        }
        console.log("game start with :" + countTime + "second after")
        countTime--;
        return "game start with :" + countTime + "second after"
    }

    function showSave(cardId) {
        saveNode.innerHTML = cardId
    }

    function showGone(goneCardId){
        goneNode.innerHTML = goneCardId;
    }

    $(document).keydown(function(event){
        if(event.keyCode == 37){
            console.log('你按下了left arrow');
            judgementLeft()
            pop()
        }
        if(event.keyCode == 39){
            console.log('你按下了right arrow');
            judgementRight()
            pop()
        }
    });

    function judgementRight(){
        if (countTime!=0 || countTime==null){
            return;
        }
        if(popNb===goneValue){
            console.log("correct!!!!!")
        }
    }

    function judgementLeft(){
        if (countTime!=0 || countTime==null){
            return;
        }
        if(popNb!=goneValue){
            console.log("correct!!!!!")
        }
    }

</script>


</body>
</html>